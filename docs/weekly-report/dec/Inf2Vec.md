# Inf2vec: Latent Representation Model for Social Influence Embedding

## 0 论文信息

**Conference**: ICDE' 2018

**Author**: Shanshan Feng, Gao Cong, Arijit Khan, Xiucheng Li, Yong Liu, Yeow Meng Chee

**Signature unit**: NTU



## 1 背景

#### 相关研究领域的空白

关于学习影响模型的现有工作都没有联合捕获**影响传播**和网络嵌入，以前的工作也没有**考虑用户兴趣相似性**。

因此，提出了一个新的研究问题：社会影响嵌入。该问题旨在将社会影响力传播有效地嵌入低维潜在空间中。

#### 需考虑的问题：

- 需要对影响用户在线行为的多个因素进行建模，包括社交网络结构、过去的影响传播和用户兴趣的相似性
- 如何基于稀疏的观察传播数据有效地学习节点的表示
- 学习过程应该是高效的，以便可以处理大规模的社交网络

#### 上下文生成

Inf2vec 模型的关键是如何从观察到的传播中生成影响上下文，即受给定用户影响的一组用户。

在这项工作中，我们考虑了产生影响上下文的两个组成部分。

- 局部影响传播邻域。给定一个社交网络和一组动作观察，提取一个传播网络，并利用传播网络上的随机游走策略来产生一组用户。这些用户充当给定用户的局部影响上下文。局部影响上下文反映网络结构和影响传播。
- 结合用户兴趣相似度的影响。对于给定的用户，随机抽样一组执行与全局用户相似度上下文相同的操作的用户。全局用户相似性上下文表示用户兴趣因素。

通过这两个组成部分，可以在学习节点嵌入中包含三个因素：局部影响上下文反映**网络结构**和**影响传播**，而全局用户相似性上下文表示**用户兴趣因素**。基于生成的影响上下文，Inf2vec 利用 word2vec 技术来学习社会影响嵌入的表示。

#### 贡献

- 研究了一个新的社会影响嵌入问题，即在低维潜在空间中表示影响传播信息。与以往大多数学习影响参数的研究不同，我们学习每个节点的潜在表示，而不是学习每个边的传播概率。据我们所知，这是第一部直接利用节点的表示来捕捉社会影响。
- 提出了一种新算法 Inf2vec 来学习节点的表示。该算法的新颖之处在于生成影响上下文，它结合了局部影响上下文和全局用户相似性上下文。因此，我们的方法能够结合三个因素：网络结构、影响扩散和用户兴趣的相似性。然而，之前的作品都没有在学习影响参数上考虑用户兴趣。
- 对两个真实数据集进行了大量实验。实证结果表明 Inf2vec 显着优于最先进的基线。



## 2 社交影响力嵌入

**动作日志 Action Log**

动作日志 $A$ 由一系列三元组构成，$(u, i, t^i_u)$，表示用户 $u$ 在时间 $t_u^i$ 做了动作 $i$

则，所有 $u$ 的传播事件集可以表示为 $D_i= \{(u, t_u^i)\}$

**假设**

1. 如果我们观察到用户 u 在用户 v 之前执行了一个动作，并且如果在社交网络中也存在有向链接（u,v），那么我们假设用户 u 影响用户 v。 该假设的潜在直觉是，如果用户 v 将用户 u 列为好友，则用户 v 可能会查看用户 u 的活动并受到用户 u 的影响。
2. 对于执行相同操作的用户，我们假设他们具有相似的用户兴趣。 这个假设在用户行为分析和推荐系统中被广泛采用。个人兴趣在用户行为中起着重要作用，用户有不同的兴趣。通过利用这一假设，我们考虑了用户对用户在线行为建模的兴趣。



### 2.1 数据观察

#### 2.1.1 数据集：

有两个数据集，

- Digg，它包含有关 2009 年 6 月在 Digg (digg.com) 的首页上显示的故事的信息。包含 823K 条边、68K 用户。该数据集还包含 Digg 投票动作，每个投票记录用户对特定故事的投票和投票时间。

- Flickr，它包含一个友谊图和一个照片共享社交网络（flickr.com）的收藏标记记录列表。有 162K 用户、10M 边。

每个动作包含（用户、项目、时间）的信息。可以观察到动作数据非常稀疏。基于这种稀疏数据有效地学习社会影响传播参数具有挑战性。

 <img src="../Inf2Vec-1.png" alt="Inf2Vec-1" style="zoom:30%;" />

#### 2.1.2 观察

给定社交图及其动作日志，根据第一个假设提取**社交影响对**。

> **社交影响对 (Social Influence Pair)** 
>
> 给定一个图 $G=(V, E)$，传播事件集 $D_i$，如果节点 $u_i$、$u_j$ 满足 $(1)u_i \in V,\ u_j ∈ V;\quad (2)(u_i,u_j) ∈ E;\quad (3)t^i_{u_i} < t^i_{u_j}$，则社交影响对 $(u_i \rightarrow u_j)$ 存在。

因此，我们为 Digg 获得了 790 万个社交影响对，为 Flickr 获得了 530 万个社交影响对。

为了检查社交影响对的特征，我们在 Digg 和 Flickr 数据集上绘制了源用户频率和目标用户频率的分布。

下图说明了 Digg 和 Flickr 上的源用户和目标用户分布。

社交影响对的源用户频率遵循幂律分布。一个用户作为源用户的频率高，说明这个用户可以影响很多用户，具有一定的影响力。大多数用户没有影响力，而一些用户在两个社交网络上都极具影响力。

同样，社交影响对的目标用户的分布也遵循幂律分布。它表明一些用户更容易受到他们朋友的影响。

 <img src="../Inf2Vec-2.png" alt="Inf2Vec-2" style="zoom:30%;" />



### 2.2 问题陈述

给定一个社交网络及其动作日志，建模影响传播旨在推断用户之间的影响概率。

 <img src="../Inf2Vec-3.png" alt="Inf2Vec-3" style="zoom:33%;" />

引入了两个术语

1. 影响能力偏差 $b_u$ 反映了用户 $u$ 影响他人的整体能力
2. 从众偏差 $\widetilde b_u$ 反映了用户 $u$ 受他人影响的倾向

**社交影响嵌入 Social Influence Embedding Problem**

给定一个社交网络 $G = (V, E)$，一个动作日志 $A = {D_i}$，其中 $D_i$ 是一个扩散事件，以及维度 $K$ 的数量，我们的目标是学习：

（1）每个用户 $u$ 在 $K$ 维潜在空间中的源嵌入 $S_u ∈ R^K$ 和目标嵌入 $T_u ∈ R^K$

（2）每个用户 $u$ 的影响能力偏差 $b_u$ 和一致性偏差 $\widetilde b$



## 3 INF2VEC 表示模型

### 3.1 生成影响上下文

#### 3.1.1 局部影响上下文

给定一个图 $G$，一个传播事件集 $D$，可以获得相应的社交影响对，但是提取得到的社会影响对仅反映一阶传播，即用户是否影响他的朋友。

因此，可以通过组合所有影响对来进一步获得高阶影响传播网络。对于每一集 $D_i$，我们建立一个**影响传播网络**，记录关于 $i$ 的信息如何在社交网络 $G$ 中传播。

**影响传播网络 Influence Propagation Network**

给定一个社交网络 $G = (V , E)$ 和一个扩散事件 $D_i$ ，传播网络是 $G_i = (V_i , E_i)$，它满足：

 $(1) V_i ⊂ V \ and \ E_i ⊂ E;$ 

$(2)\forall (u,v)∈ E_i, \ \exists (u \rightarrow  v) \in Di$

下图为影响传播网络的构建示例，

 <img src="../Inf2Vec-4.png" alt="Inf2Vec-4" style="zoom:20%;" />

考虑社交网络中的高阶影响，利用带有重启过程的随机游走来模拟用户在影响传播网络中的影响传播。

这种方法有两个好处：

1. 可以模拟影响传播序列，因此可以考虑高阶影响
2. 通过额外考虑高阶影响，它可以产生更多的影响对，因此减轻了由扩散数据的稀疏性引起的挑战

给定影响传播网络 $G_i$ 和用户 $u$，生成影响上下文集 $C_u^i$ ，其中包含可能受用户 $u$ 影响的用户，使用了一个长度阈值 $L_θ$，当达到 $L_θ$ 时，随机游走过程停止。



#### 3.1.2 全局相似度上下文

全局相似度上下文进一步考虑了生成影响上下文的用户偏好相似度。

在同一个影响传播网络中的节点，具有相同的兴趣偏好。

在给定影响传播网络 $G_i = (V_i , E_i)$ 中的用户 $u$，在 $V_i$ 中随机采样一组用户，用 $L'_θ$ 表示。局部影响上下文只反映局部邻域，而相似用户的样本可以反映全局上下文。因此，将这些采样用户视为全局用户相似度上下文。



#### 3.1.3 结合两者的算法

1. 为了平衡这两个分量的贡献，使用分量权重 $α$

2. 通过使用从用户 $u$ 开始的随机游走生成 $(L_θ = L · α)$ 局部影响邻居
3. 接下来，从 $V_i$ 中的节点中随机采样 $(L'_θ = L·(1−α))$ 个用户
4. 通过这种方式，影响上下文集 $C_u^i$ 由两种类型的节点组成

 <img src="../Inf2Vec-5.png" alt="Inf2Vec-5" style="zoom:25%;" />



### 3.2 学习表征

利用 word2vec 技术来学习每个用户的潜在表示。

利用 skip-gram 架构，即预测给定用户的上下文。影响嵌入的关键是估计观察到与相应情节 $D_i$ 生成的影响上下文 $P(C_u^i | u)$ 的概率。假设用户 ${v ∈ C_u^i}$ 相互独立，则概率 $Pr(C_u^i |u)$ 由每个独立的概率 $Pr(v|u)$ 决定。$Pr(C_u^i|u) = \prod_{v \in C_u^i} Pr(v|u)$。

用户 v 受用户 u 影响的概率，可以将其表述为 softmax 函数：

$Pr(v|u) = e^{(Su·Tv+bu+bv)}/Z(u)$

其中，$S_u · T_v$ 代表<u>用户 u 作为源表示的 $S_u$</u>  和<u>用户 u 作为目标表示的 $T_v$</u> 的内积，

使用采样的负实例来近似 softmax 函数，

$log Pr(v|u) ≈ log σ(z_v ) + \sum_{w \in N} log \sigma(-z_w)$

利用随机梯度下降 (SGD) 来学习所有参数，在每一步中，通过计算梯度来更新参数 Θ：

$\theta \leftarrow \theta + \gamma \frac{\partial}{\partial \theta}(log(Pr(v|u)))$

$\frac{\partial}{\partial S_u} = (1-\sigma(z_v)) \cdot T_v + \sum_{w \in N}(-\sigma(z_w)) \cdot T_w$

$\frac{\partial}{\partial T_v} = (1-\sigma(z_v)) \cdot S_u$， $\frac{\partial}{\partial T_w} = (- \sigma(z_w)) \cdot S_u$

$\frac{\partial}{\partial b_u} = (1-\sigma(z_v)) + \sum_{w \in N}(-\sigma(z_w))$

$\frac{\partial}{\partial \widetilde b_v} = (1-\sigma(z_v))$， $\frac{\partial}{\partial \widetilde b_v} = (- \sigma(z_w))$

 <img src="../Inf2Vec-6.png" alt="Inf2Vec-6" style="zoom:30%;" />



### 3.3 预测影响传播

$F ({x(u,v),u ∈ S_v})$

其中，$x(u, v) = S_u · T_v + b + \widetilde b$，表示 u 影响 v 的可能性，$F()$ 是一个聚合函数。

本文考虑了四种聚合形式：

1. Ave
2. Sum
3. Max
4. Latest



## 4 实验

### 4.1 实验设置

**数据集**

1. Digg、Flickr。对于 Digg 和 Flickr 的动作日志 A = {Di}，随机选择 80% 作为训练集，10% 作为调整集，10% 作为测试集。

2. DBLP 引文网络。进行案例研究。

**参数设置**

默认维数 K=50

长度阈值 L=50

默认组件权重 α = 0.1

学习率 γ = 0.005

聚合函数为 Ave

**评估方法**

1. DE：基于度的方法，每条边的概率设置为 $P_{uv} = \frac{1}{Indegree(v)}$
2. ST：具有最大似然估计的静态模型方法，边 (u,v) 的概率 Puv 由 Puv = Auv 计算，其中 Auv 是用户 u 在用户 v 之前执行的动作数，Au 是 u 执行的动作总数。
3. EM：基于独立级联(IC) 模型的期望最大化方法，它学习每条边的传播概率。
4. Emb-IC：嵌入式级联模型，参数通过类似于 EM 算法进行推断。
5. MF：Bayesian Personalized Ranking 的用户-用户矩阵分解方法。矩阵的条目是两个用户执行相同操作的频率。如果两个用户没有共享任何共同动作，则该条目设置为0。注意该方法仅反映全局用户相似度。
6. Node2vec：只考虑社交网络结构。
7. Inf2vec：考虑了局部影响上下文和全局用户相似性上下文。

**评估任务**

1. 激活预测。即预测用户是否会受到他的朋友的影响。它仅考虑一阶影响传播。
2. 扩散预测。给定一组种子用户，尝试识别受他们影响的用户。与激活预测不同，扩散预测额外考虑了高阶传播。
3. 可视化。为了更好地理解学习到的表示，我们使用降维工具将它们映射到二维空间



### 4.2 实验一 激活预测任务

给定一个测试集 $D = \{(u, t_i )\}$，其中包含用户的时间顺序，我们希望预测未来将执行操作 $i$ 的用户。

激活的用户集最初是空的。 通过一一阅读 $D_i$ 中的记录。一旦读取了一条记录 $(u, t^i_u )$，就将 $u$ 插入到激活用户的集合中。这些激活的用户会进一步影响其他用户。如果用户 $v$ 至少有一个朋友执行了该操作，则该 $v$ 是候选用户。令 $S_v$ 表示可能影响用户 $v$ 的激活邻居集合，这样就可以得到候选用户及其激活的朋友，即 $\{(v,S_v)\}$。 

激活预测任务即为试图预测候选用户 $v$ 是否会被 $S_v$ 激活。



### 4.3 实验二 扩散预测任务

**扩散预测任务**

给定一组激活的用户，尝试确定将受他们影响的一组用户。

**基本设置**

对于每个测试集，将前 5% 的用户作为种子用户，将其余 95% 的用户用作 ground-truth。

对于表示模型（FMC、MF、Node2vec 和 Inf2Vec），直接使用 $F ({x(u,v),u ∈ S_v})$ 计算分数。

对于基于 IC 的模型（DT、ST、EM 和 Emb-IC），利用 Monte-Carlo 模拟来估计每个用户的概率分数。

**评估指标**

利用 AUC、MAP 和 P@N 作为评估措施。

1. AUC。利用接收者操作特征 (ROC) 的曲线下面积 (AUC) 值。利用排名方案来计算 AUC 值。
2. MAP。由于只有很小一部分测试用例是正面的（被其邻居激活），而大多数是负面的（不被其邻居激活），平均精度（MAP）对于这种不平衡的情况是有用的。
3. P@N。因为对用户受到朋友影响的正面案例更感兴趣，因此研究了 top-N 预测的精度。在我们的实验中，我们分别将 N 设置为 10、50 和 100。

**实验结果**

各种方法在 Digg 和 Flickr 上的实验结果如下表所示。

Inf2vec 总是在两个数据集上都达到最佳性能。

表示模型能够有效地捕捉影响传播信息。

Inf2vec-L 的性能比 Infvec 差，说明用户兴趣相似度的重要性。

使用 IC 模型的 Monco-Carlo 模拟非常耗时，而表示模型可以在更短的时间内完成预测任务。

 <img src="../Inf2Vec-7.png" alt="Inf2Vec-7" style="zoom:25%;" />



























